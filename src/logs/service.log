2025-10-25 21:13:24,595 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 21:13:24,598 - INFO - SQL执行结果:[{'count': 139931, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 135384, 'seq': 3}]
2025-10-25 21:13:24,599 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期查表计划数量(支)': 139931, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 135384}}
2025-10-25 21:13:25,222 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 21:13:25,222 - INFO - SQL执行结果:[{'count': 53584, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 41384, 'seq': 3}]
2025-10-25 21:13:25,223 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期查表计划数量(支)': 53584, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 41384}}
2025-10-25 21:13:25,223 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【生产环境】查表计划当前生成情况：\n石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384\n长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384"}]
2025-10-25 21:16:58,404 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 21:16:58,405 - INFO - SQL执行结果:[{'count': 139931, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 135384, 'seq': 3}]
2025-10-25 21:16:58,405 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期查表计划数量(支)': 139931, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 135384}}
2025-10-25 21:16:58,968 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 21:16:58,968 - INFO - SQL执行结果:[{'count': 53584, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 41384, 'seq': 3}]
2025-10-25 21:16:58,969 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期查表计划数量(支)': 53584, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 41384}}
2025-10-25 21:16:58,969 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【生产环境】查表计划当前生成情况：\n石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384\n长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384"}]
2025-10-25 21:18:00,647 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:18:04,553 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:18:04,798 - INFO - Added job "远传出账配置项: daily" to job store "default"
2025-10-25 21:18:04,800 - INFO - Scheduler started
2025-10-25 21:18:18,847 - INFO - Running job "run (trigger: date[2025-10-25 21:18:18 CST], pending)" (scheduled at 2025-10-25 21:18:18.846296)
2025-10-25 21:18:18,856 - INFO - Executing pipeline `远传出账配置项` #2 via trigger `_manual`
2025-10-25 21:18:18,857 - INFO - Executing task fetch_raw_sales_data
2025-10-25 21:18:18,860 - DEBUG - 获取销售记录...
2025-10-25 21:18:18,862 - INFO - 已获取 50 行销售记录
2025-10-25 21:18:18,864 - INFO - Executing task fetch_raw_sales_data1
2025-10-25 21:18:18,866 - DEBUG - 获取销售记录...
2025-10-25 21:18:18,867 - INFO - 已获取 50 行销售记录
2025-10-25 21:18:18,869 - INFO - Executing task run_fetch_wmr_pro
2025-10-25 21:18:18,875 - INFO - Job "run (trigger: date[2025-10-25 21:18:18 CST], pending)" executed successfully
2025-10-25 21:20:20,491 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:20:24,380 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:20:24,485 - INFO - Added job "远传出账配置项: daily" to job store "default"
2025-10-25 21:20:24,486 - INFO - Scheduler started
2025-10-25 21:20:49,454 - INFO - Running job "run (trigger: date[2025-10-25 21:20:49 CST], pending)" (scheduled at 2025-10-25 21:20:49.454642)
2025-10-25 21:20:49,464 - INFO - Executing pipeline `远传出账配置项` #3 via trigger `_manual`
2025-10-25 21:20:49,465 - INFO - Executing task fetch_raw_sales_data
2025-10-25 21:20:49,470 - DEBUG - 获取销售记录...
2025-10-25 21:20:49,471 - INFO - 已获取 50 行销售记录
2025-10-25 21:20:49,474 - INFO - Executing task fetch_raw_sales_data1
2025-10-25 21:20:49,476 - DEBUG - 获取销售记录...
2025-10-25 21:20:49,477 - INFO - 已获取 50 行销售记录
2025-10-25 21:20:49,480 - INFO - Executing task run_fetch_wmr_pro
2025-10-25 21:20:49,481 - ERROR - 'Task' object is not callable
Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\orchestrator\executor.py", line 129, in run
    flowing_data = await _execute_task(task, flowing_data, pipeline_params)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\orchestrator\executor.py", line 195, in _execute_task
    result = await task.run(*args, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\pipeline\__init__.py", line 15, in wrapper_decorator
    value = await func(*args, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\app.py", line 13, in run_fetch_wmr_pro
    run_fetch_wmr_pro()
TypeError: 'Task' object is not callable
2025-10-25 21:20:49,492 - INFO - Job "run (trigger: date[2025-10-25 21:20:49 CST], pending)" executed successfully
2025-10-25 21:21:47,419 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:21:51,263 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:21:51,369 - INFO - Added job "远传出账配置项: daily" to job store "default"
2025-10-25 21:21:51,370 - INFO - Scheduler started
2025-10-25 21:22:02,949 - INFO - Running job "run (trigger: date[2025-10-25 21:22:02 CST], pending)" (scheduled at 2025-10-25 21:22:02.949623)
2025-10-25 21:22:02,960 - INFO - Executing pipeline `远传出账配置项` #4 via trigger `_manual`
2025-10-25 21:22:02,961 - INFO - Executing task fetch_raw_sales_data
2025-10-25 21:22:02,964 - DEBUG - 获取销售记录...
2025-10-25 21:22:02,965 - INFO - 已获取 50 行销售记录
2025-10-25 21:22:02,969 - INFO - Executing task fetch_raw_sales_data1
2025-10-25 21:22:02,971 - DEBUG - 获取销售记录...
2025-10-25 21:22:02,972 - INFO - 已获取 50 行销售记录
2025-10-25 21:22:02,975 - INFO - Executing task run_fetch_wmr_pro
2025-10-25 21:22:02,977 - ERROR - 'Task' object is not callable
Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\orchestrator\executor.py", line 129, in run
    flowing_data = await _execute_task(task, flowing_data, pipeline_params)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\orchestrator\executor.py", line 195, in _execute_task
    result = await task.run(*args, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\pipeline\__init__.py", line 15, in wrapper_decorator
    value = await func(*args, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\app.py", line 13, in run_fetch_wmr_pro
    await run_fetch_wmr_pro()
TypeError: 'Task' object is not callable
2025-10-25 21:22:02,987 - INFO - Job "run (trigger: date[2025-10-25 21:22:02 CST], pending)" executed successfully
2025-10-25 21:23:55,351 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:23:59,385 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:23:59,466 - INFO - Added job "远传出账配置项: daily" to job store "default"
2025-10-25 21:23:59,467 - INFO - Scheduler started
2025-10-25 21:24:06,584 - INFO - Running job "run (trigger: date[2025-10-25 21:24:06 CST], pending)" (scheduled at 2025-10-25 21:24:06.583785)
2025-10-25 21:24:06,592 - INFO - Executing pipeline `远传出账配置项` #5 via trigger `_manual`
2025-10-25 21:24:06,593 - INFO - Executing task fetch_raw_sales_data
2025-10-25 21:24:06,596 - DEBUG - 获取销售记录...
2025-10-25 21:24:06,597 - INFO - 已获取 50 行销售记录
2025-10-25 21:24:06,600 - INFO - Executing task fetch_raw_sales_data1
2025-10-25 21:24:06,601 - DEBUG - 获取销售记录...
2025-10-25 21:24:06,601 - INFO - 已获取 50 行销售记录
2025-10-25 21:24:06,604 - INFO - Executing task run_fetch_wmr_pro
2025-10-25 21:24:08,635 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 21:24:08,636 - INFO - SQL执行结果:[{'count': 139931, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 135384, 'seq': 3}]
2025-10-25 21:24:08,637 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期查表计划数量(支)': 139931, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 135384}}
2025-10-25 21:24:09,264 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 21:24:09,265 - INFO - SQL执行结果:[{'count': 53584, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 41384, 'seq': 3}]
2025-10-25 21:24:09,265 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期查表计划数量(支)': 53584, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 41384}}
2025-10-25 21:24:09,266 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【生产环境】查表计划当前生成情况：\n石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384\n长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384"}]
2025-10-25 21:24:09,274 - INFO - Job "run (trigger: date[2025-10-25 21:24:06 CST], pending)" executed successfully
2025-10-25 21:27:47,597 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:27:50,646 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:27:50,729 - INFO - Added job "远传出账配置项: daily" to job store "default"
2025-10-25 21:27:50,730 - INFO - Scheduler started
2025-10-25 21:27:57,329 - INFO - Running job "run (trigger: date[2025-10-25 21:27:57 CST], pending)" (scheduled at 2025-10-25 21:27:57.328404)
2025-10-25 21:27:57,340 - INFO - Executing pipeline `远传出账配置项` #6 via trigger `_manual`
2025-10-25 21:27:57,341 - INFO - Executing task fetch_raw_sales_data
2025-10-25 21:27:57,346 - DEBUG - 获取销售记录...
2025-10-25 21:27:57,347 - INFO - 已获取 50 行销售记录
2025-10-25 21:27:57,351 - INFO - Executing task fetch_raw_sales_data1
2025-10-25 21:27:57,353 - DEBUG - 获取销售记录...
2025-10-25 21:27:57,354 - INFO - 已获取 50 行销售记录
2025-10-25 21:27:57,357 - INFO - Executing task run_fetch_wmr_pro
2025-10-25 21:27:59,465 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 21:27:59,466 - INFO - SQL执行结果:[{'count': 139931, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 135384, 'seq': 3}]
2025-10-25 21:27:59,467 - ERROR - module 'run.src.utils.logger' has no attribute 'info'
Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\orchestrator\executor.py", line 129, in run
    flowing_data = await _execute_task(task, flowing_data, pipeline_params)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\orchestrator\executor.py", line 195, in _execute_task
    result = await task.run(*args, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\pipeline\__init__.py", line 22, in wrapper_decorator
    value = await asyncio.to_thread(func, *args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\fetch_trans_data.py", line 91, in run_fetch_wmr_pro
    message = build_sms_message()
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\fetch_trans_data.py", line 76, in build_sms_message
    data = fetch_data_by_company(company)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\fetch_trans_data.py", line 66, in fetch_data_by_company
    logger.info("处理后数据：%s", res)
AttributeError: module 'run.src.utils.logger' has no attribute 'info'
2025-10-25 21:27:59,476 - INFO - Job "run (trigger: date[2025-10-25 21:27:57 CST], pending)" executed successfully
2025-10-25 21:29:00,358 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:29:04,485 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:29:04,566 - INFO - Added job "远传出账配置项: daily" to job store "default"
2025-10-25 21:29:04,567 - INFO - Scheduler started
2025-10-25 21:29:11,471 - INFO - Running job "run (trigger: date[2025-10-25 21:29:11 CST], pending)" (scheduled at 2025-10-25 21:29:11.470364)
2025-10-25 21:29:11,479 - INFO - Executing pipeline `远传出账配置项` #7 via trigger `_manual`
2025-10-25 21:29:11,481 - INFO - Executing task run_fetch_wmr_pro
2025-10-25 21:29:13,404 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 21:29:13,405 - INFO - SQL执行结果:[{'count': 139931, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 135384, 'seq': 3}]
2025-10-25 21:29:13,405 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期查表计划数量(支)': 139931, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 135384}}
2025-10-25 21:29:13,972 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 21:29:13,972 - INFO - SQL执行结果:[{'count': 53584, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 41384, 'seq': 3}]
2025-10-25 21:29:13,972 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期查表计划数量(支)': 53584, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 41384}}
2025-10-25 21:29:13,973 - INFO - 【生产环境】查表计划当前生成情况：
石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384
长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384
2025-10-25 21:29:13,985 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【生产环境】查表计划当前生成情况：\n石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384\n长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384"}]
2025-10-25 21:29:13,992 - INFO - Job "run (trigger: date[2025-10-25 21:29:11 CST], pending)" executed successfully
2025-10-25 21:45:58,145 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:45:58,146 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:46:01,145 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:46:01,146 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:46:01,233 - INFO - Added job "远传出账配置项: daily" to job store "default"
2025-10-25 21:46:01,234 - INFO - Added job "远传出账数量统计: daily" to job store "default"
2025-10-25 21:46:01,234 - INFO - Scheduler started
2025-10-25 21:47:28,127 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:47:28,128 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:47:28,286 - INFO - Added job "远传出账配置项: daily" to job store "default"
2025-10-25 21:47:28,288 - INFO - Added job "远传出账数量统计: daily" to job store "default"
2025-10-25 21:47:28,289 - INFO - Scheduler started
2025-10-25 21:50:00,012 - INFO - Running job "远传出账配置项: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-25 21:55:00 CST)" (scheduled at 2025-10-25 21:50:00+08:00)
2025-10-25 21:50:00,025 - INFO - Executing pipeline `远传出账配置项` #8 via trigger `daily`
2025-10-25 21:50:00,026 - INFO - Executing task run_fetch_wmr_pro
2025-10-25 21:50:03,916 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 21:50:03,917 - INFO - SQL执行结果:[{'count': 139931, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 135384, 'seq': 3}]
2025-10-25 21:50:03,917 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期查表计划数量(支)': 139931, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 135384}}
2025-10-25 21:50:04,712 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 21:50:04,713 - INFO - SQL执行结果:[{'count': 53584, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 41384, 'seq': 3}]
2025-10-25 21:50:04,714 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期查表计划数量(支)': 53584, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 41384}}
2025-10-25 21:50:04,715 - INFO - 【生产环境】查表计划当前生成情况：
石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384
长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384
2025-10-25 21:50:04,716 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【生产环境】查表计划当前生成情况：\n石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384\n长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384"}]
2025-10-25 21:50:04,725 - INFO - Job "远传出账配置项: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-25 21:55:00 CST)" executed successfully
2025-10-25 21:52:34,553 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:52:34,553 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:52:37,756 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:52:37,757 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-25 21:52:37,849 - INFO - Added job "远传出账配置项: daily" to job store "default"
2025-10-25 21:52:37,850 - INFO - Added job "远传出账数量统计: daily" to job store "default"
2025-10-25 21:52:37,851 - INFO - Scheduler started
2025-10-25 21:55:00,008 - INFO - Running job "远传出账配置项: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-25 22:00:00 CST)" (scheduled at 2025-10-25 21:55:00+08:00)
2025-10-25 21:55:00,021 - INFO - Executing pipeline `远传出账配置项` #9 via trigger `daily`
2025-10-25 21:55:00,022 - INFO - Executing task run_fetch_wmr_pro
2025-10-25 21:55:01,965 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 21:55:01,965 - INFO - SQL执行结果:[{'count': 139931, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 135384, 'seq': 3}]
2025-10-25 21:55:01,966 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期查表计划数量(支)': 139931, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 135384}}
2025-10-25 21:55:02,460 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 21:55:02,461 - INFO - SQL执行结果:[{'count': 53584, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 41384, 'seq': 3}]
2025-10-25 21:55:02,461 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期查表计划数量(支)': 53584, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 41384}}
2025-10-25 21:55:02,461 - INFO - 【生产环境】查表计划当前生成情况：
石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384
长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384
2025-10-25 21:55:02,462 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【生产环境】查表计划当前生成情况：\n石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384\n长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384"}]
2025-10-25 21:55:02,469 - INFO - Job "远传出账配置项: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-25 22:00:00 CST)" executed successfully
2025-10-25 22:00:00,009 - INFO - Running job "远传出账配置项: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-25 22:05:00 CST)" (scheduled at 2025-10-25 22:00:00+08:00)
2025-10-25 22:00:00,019 - INFO - Executing pipeline `远传出账配置项` #10 via trigger `daily`
2025-10-25 22:00:00,020 - INFO - Executing task run_fetch_wmr_pro
2025-10-25 22:00:02,172 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 22:00:02,173 - INFO - SQL执行结果:[{'count': 139931, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 135384, 'seq': 3}]
2025-10-25 22:00:02,173 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期查表计划数量(支)': 139931, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 135384}}
2025-10-25 22:00:02,790 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 22:00:02,792 - INFO - SQL执行结果:[{'count': 53584, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 41384, 'seq': 3}]
2025-10-25 22:00:02,792 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期查表计划数量(支)': 53584, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 41384}}
2025-10-25 22:00:02,793 - INFO - 【生产环境】查表计划当前生成情况：
石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384
长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384
2025-10-25 22:00:02,794 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【生产环境】查表计划当前生成情况：\n石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384\n长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384"}]
2025-10-25 22:00:02,800 - INFO - Job "远传出账配置项: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-25 22:05:00 CST)" executed successfully
2025-10-25 22:05:00,006 - INFO - Running job "远传出账配置项: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-25 22:10:00 CST)" (scheduled at 2025-10-25 22:05:00+08:00)
2025-10-25 22:05:00,017 - INFO - Executing pipeline `远传出账配置项` #11 via trigger `daily`
2025-10-25 22:05:00,017 - INFO - Executing task run_fetch_wmr_pro
2025-10-25 22:05:02,049 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 22:05:02,049 - INFO - SQL执行结果:[{'count': 139931, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 135384, 'seq': 3}]
2025-10-25 22:05:02,050 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期查表计划数量(支)': 139931, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 135384}}
2025-10-25 22:05:02,578 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 22:05:02,578 - INFO - SQL执行结果:[{'count': 53584, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 41384, 'seq': 3}]
2025-10-25 22:05:02,579 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期查表计划数量(支)': 53584, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 41384}}
2025-10-25 22:05:02,579 - INFO - 【生产环境】查表计划当前生成情况：
石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384
长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384
2025-10-25 22:05:02,580 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【生产环境】查表计划当前生成情况：\n石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384\n长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384"}]
2025-10-25 22:05:02,587 - INFO - Job "远传出账配置项: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-25 22:10:00 CST)" executed successfully
2025-10-25 22:10:00,009 - INFO - Running job "远传出账配置项: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-25 22:15:00 CST)" (scheduled at 2025-10-25 22:10:00+08:00)
2025-10-25 22:10:00,016 - INFO - Executing pipeline `远传出账配置项` #12 via trigger `daily`
2025-10-25 22:10:00,017 - INFO - Executing task run_fetch_wmr_pro
2025-10-25 22:10:02,390 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 22:10:02,391 - INFO - SQL执行结果:[{'count': 139931, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 135384, 'seq': 3}]
2025-10-25 22:10:02,391 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期查表计划数量(支)': 139931, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 135384}}
2025-10-25 22:10:02,948 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 22:10:02,948 - INFO - SQL执行结果:[{'count': 53584, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 41384, 'seq': 3}]
2025-10-25 22:10:02,949 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期查表计划数量(支)': 53584, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 41384}}
2025-10-25 22:10:02,949 - INFO - 【生产环境】查表计划当前生成情况：
石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384
长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384
2025-10-25 22:10:02,950 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【生产环境】查表计划当前生成情况：\n石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384\n长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384"}]
2025-10-25 22:10:02,956 - INFO - Job "远传出账配置项: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-25 22:15:00 CST)" executed successfully
2025-10-25 22:15:00,008 - INFO - Running job "远传出账配置项: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-25 22:20:00 CST)" (scheduled at 2025-10-25 22:15:00+08:00)
2025-10-25 22:15:00,017 - INFO - Executing pipeline `远传出账配置项` #13 via trigger `daily`
2025-10-25 22:15:00,018 - INFO - Executing task run_fetch_wmr_pro
2025-10-25 22:15:02,089 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 22:15:02,089 - INFO - SQL执行结果:[{'count': 139931, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 135384, 'seq': 3}]
2025-10-25 22:15:02,089 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期查表计划数量(支)': 139931, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 135384}}
2025-10-25 22:15:02,656 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-25 22:15:02,657 - INFO - SQL执行结果:[{'count': 53584, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 41384, 'seq': 3}]
2025-10-25 22:15:02,657 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期查表计划数量(支)': 53584, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 41384}}
2025-10-25 22:15:02,658 - INFO - 【生产环境】查表计划当前生成情况：
石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384
长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384
2025-10-25 22:15:02,659 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【生产环境】查表计划当前生成情况：\n石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384\n长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384"}]
2025-10-25 22:15:02,665 - INFO - Job "远传出账配置项: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-25 22:20:00 CST)" executed successfully
2025-10-26 13:47:11,626 - INFO - 当前执行sql:
        select param_code,param_state,param_value from water_revenue.sys_param where param_code in ('0125','0126')
    
2025-10-26 13:47:11,629 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '1000'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '1000'}]
2025-10-26 13:48:02,164 - INFO - 当前执行sql:
        select param_code,param_state,param_value from water_revenue.sys_param where param_code in ('0125','0126')
    
2025-10-26 13:48:02,165 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '1000'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '1000'}]
2025-10-26 13:52:45,564 - INFO - 当前执行sql:
        select param_code,param_state,param_value from water_revenue.sys_param where param_code in ('0125','0126')
    
2025-10-26 13:52:45,565 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '1000'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '1000'}]
2025-10-26 13:55:54,979 - INFO - 当前执行sql:
        select param_code,param_state,param_value from water_revenue.sys_param where param_code in ('0125','0126')
    
2025-10-26 13:55:54,979 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '1000'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '1000'}]
2025-10-26 13:56:17,668 - INFO - 当前执行sql:
        select param_code,param_state,param_value from water_revenue.sys_param where param_code in ('0125','0126')
    
2025-10-26 13:56:17,669 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '1000'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '1000'}]
2025-10-26 13:57:42,986 - INFO - 当前执行sql:
        select param_code,param_state,param_value from water_revenue.sys_param where param_code in ('0125','0126')
    
2025-10-26 13:57:42,986 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '1000'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '1000'}]
2025-10-26 13:58:08,647 - INFO - 当前执行sql:
        select param_code,param_state,param_value from water_revenue.sys_param where param_code in ('0125','0126')
    
2025-10-26 13:58:08,647 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '1000'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '1000'}]
2025-10-26 14:01:10,889 - INFO - 当前执行sql:
          SELECT param_code, param_state, param_value
          FROM water_revenue.sys_param
          WHERE param_code IN ('0125', '0126')           
2025-10-26 14:01:10,891 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '1000'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '1000'}]
2025-10-26 14:02:08,250 - INFO - 当前执行sql:
          SELECT param_code, param_state, param_value
          FROM water_revenue.sys_param
          WHERE param_code IN ('0125', '0126')           
2025-10-26 14:02:08,250 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '2'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '3'}]
2025-10-26 14:02:46,894 - INFO - 当前执行sql:
          SELECT param_code, param_state, param_value
          FROM water_revenue.sys_param
          WHERE param_code IN ('0125', '0126')           
2025-10-26 14:02:46,895 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '2'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '3'}]
2025-10-26 14:27:49,742 - ERROR - 检查日历配置时发生异常: tuple index out of range
Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\check_config.py", line 133, in check_work_day_jq
    res = db.query(sql)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\utils\dbutils.py", line 41, in query
    cursor.execute(sql, params or ())
IndexError: tuple index out of range
2025-10-26 14:28:43,725 - ERROR - 检查日历配置时发生异常: tuple index out of range
Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\check_config.py", line 133, in check_work_day_jq
    res = db.query(sql)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\utils\dbutils.py", line 41, in query
    cursor.execute(sql, params or ())
IndexError: tuple index out of range
2025-10-26 14:31:29,736 - ERROR - 检查日历配置时发生异常: tuple index out of range
Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\check_config.py", line 133, in check_work_day_jq
    res = db.query(sql)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\utils\dbutils.py", line 41, in query
    cursor.execute(sql, params or ())
IndexError: tuple index out of range
2025-10-26 14:32:47,227 - ERROR - 检查日历配置时发生异常: tuple index out of range
Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\check_config.py", line 133, in check_work_day_jq
    res = db.query(sql,params=None)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\utils\dbutils.py", line 41, in query
    cursor.execute(sql, params or ())
IndexError: tuple index out of range
2025-10-26 14:33:44,981 - INFO - 当前执行sql:
    select cal_day,is_work_day,work_day_seq,is_make_day from water_revenue.calendar_date where cal_day like '2025-11%' order by cal_day ;
    
2025-10-26 14:33:44,983 - INFO - SQL执行结果:[{'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}]
2025-10-26 14:33:44,987 - ERROR - 约束1失败: 日期 '01' 不等于 work_day_seq 'None'
2025-10-26 14:34:12,803 - INFO - 当前执行sql:
    select cal_day,is_work_day,work_day_seq,is_make_day from water_revenue.calendar_date where cal_day like '2025-11%' order by cal_day ;
    
2025-10-26 14:34:12,804 - INFO - SQL执行结果:[{'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}]
2025-10-26 14:34:12,806 - ERROR - 约束1失败: 日期 '01' 不等于 work_day_seq 'None'
2025-10-26 14:46:24,777 - INFO - 当前执行sql:
          SELECT param_code, param_state, param_value
          FROM water_revenue.sys_param
          WHERE param_code IN ('0125', '0126')           
2025-10-26 14:46:24,778 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '2'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '3'}]
2025-10-26 14:46:24,779 - INFO - 远传出账取数时间范围正确√
2025-10-26 14:46:25,242 - INFO - 当前执行sql:
    select cal_day,is_work_day,work_day_seq,is_make_day from water_revenue.calendar_date where cal_day like '2025-11%' order by cal_day ;
    
2025-10-26 14:46:25,243 - INFO - SQL执行结果:[{'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}]
2025-10-26 14:46:25,244 - ERROR - 约束1失败: 日期 '01' 不等于 work_day_seq 'None'
2025-10-26 14:46:25,245 - ERROR - 工作日与户表开账日配置错误，需要调整×
2025-10-26 14:46:25,245 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "远传出账取数时间范围正确√\n工作日与户表开账日配置错误，需要调整×\n"}]
2025-10-26 14:47:36,994 - INFO - 当前执行sql:
          SELECT param_code, param_state, param_value
          FROM water_revenue.sys_param
          WHERE param_code IN ('0125', '0126')           
2025-10-26 14:47:36,995 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '2'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '3'}]
2025-10-26 14:47:36,996 - INFO - 远传出账取数时间范围正确√
2025-10-26 14:47:37,498 - INFO - 当前执行sql:
    select cal_day,is_work_day,work_day_seq,is_make_day from water_revenue.calendar_date where cal_day like '2025-11%' order by cal_day ;
    
2025-10-26 14:47:37,499 - INFO - SQL执行结果:[{'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}]
2025-10-26 14:47:37,502 - ERROR - 约束1失败: 日期 '01' 不等于 work_day_seq 'None'
2025-10-26 14:47:37,503 - ERROR - 工作日与户表开账日配置错误，需要调整×
2025-10-26 14:47:37,503 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【系统参数0125/0126】远传出账取数时间范围正确√\n【计划管理】工作日与户表开账日配置错误，需要调整×\n"}]
2025-10-26 14:58:06,486 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 14:58:06,488 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 14:58:12,085 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 14:58:12,086 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 14:58:12,243 - INFO - Added job "check: daily" to job store "default"
2025-10-26 14:58:12,246 - INFO - Added job "fetch: daily" to job store "default"
2025-10-26 14:58:12,246 - INFO - Scheduler started
2025-10-26 15:00:00,025 - INFO - Running job "check: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 15:05:00 CST)" (scheduled at 2025-10-26 15:00:00+08:00)
2025-10-26 15:00:00,041 - INFO - Executing pipeline `check` #14 via trigger `daily`
2025-10-26 15:00:00,042 - INFO - Executing task check_config_job
2025-10-26 15:00:00,043 - INFO - Running job "fetch: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 15:05:00 CST)" (scheduled at 2025-10-26 15:00:00+08:00)
2025-10-26 15:00:00,053 - INFO - Executing pipeline `fetch` #15 via trigger `daily`
2025-10-26 15:00:00,055 - INFO - Executing task run_fetch_wmr_pro
2025-10-26 15:00:00,585 - INFO - 当前执行sql:
          SELECT param_code, param_state, param_value
          FROM water_revenue.sys_param
          WHERE param_code IN ('0125', '0126')           
2025-10-26 15:00:00,588 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '2'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '3'}]
2025-10-26 15:00:00,589 - INFO - 远传出账取数时间范围正确√
2025-10-26 15:00:01,563 - INFO - 当前执行sql:
    select cal_day,is_work_day,work_day_seq,is_make_day from water_revenue.calendar_date where cal_day like '2025-11%' order by cal_day ;
    
2025-10-26 15:00:01,564 - INFO - SQL执行结果:[{'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}]
2025-10-26 15:00:01,568 - ERROR - 约束1失败: 日期 '01' 不等于 work_day_seq 'None'
2025-10-26 15:00:01,568 - ERROR - 工作日与户表开账日配置错误，需要调整
2025-10-26 15:00:01,570 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【系统参数0125/0126】远传出账取数时间范围正确√\n【计划管理】工作日与户表开账日配置错误，需要调整\n"}]
2025-10-26 15:00:01,582 - INFO - Job "check: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 15:05:00 CST)" executed successfully
2025-10-26 15:01:23,526 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-26 15:01:23,528 - INFO - SQL执行结果:[{'count': 139931, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 135384, 'seq': 3}]
2025-10-26 15:01:23,529 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期查表计划数量(支)': 139931, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 135384}}
2025-10-26 15:01:27,845 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-26 15:01:27,847 - INFO - SQL执行结果:[{'count': 53584, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 41384, 'seq': 3}]
2025-10-26 15:01:27,849 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期查表计划数量(支)': 53584, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 41384}}
2025-10-26 15:01:27,851 - INFO - 【生产环境】查表计划当前生成情况：
石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384
长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384
2025-10-26 15:01:27,853 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【生产环境】查表计划当前生成情况：\n石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384\n长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384"}]
2025-10-26 15:01:27,871 - INFO - Job "fetch: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 15:05:00 CST)" executed successfully
2025-10-26 15:05:00,223 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 15:05:00,224 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 15:05:04,200 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 15:05:04,201 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 15:05:04,293 - INFO - Added job "check: daily" to job store "default"
2025-10-26 15:05:04,295 - INFO - Added job "fetch: daily" to job store "default"
2025-10-26 15:05:04,295 - INFO - Scheduler started
2025-10-26 15:10:00,012 - INFO - Running job "check: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 15:15:00 CST)" (scheduled at 2025-10-26 15:10:00+08:00)
2025-10-26 15:10:00,040 - INFO - Executing pipeline `check` #16 via trigger `daily`
2025-10-26 15:10:00,045 - INFO - Executing task check_config_job
2025-10-26 15:10:00,094 - INFO - Running job "fetch: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 15:15:00 CST)" (scheduled at 2025-10-26 15:10:00+08:00)
2025-10-26 15:10:00,126 - INFO - Executing pipeline `fetch` #17 via trigger `daily`
2025-10-26 15:10:00,127 - INFO - Executing task run_fetch_wmr_pro
2025-10-26 15:10:00,637 - INFO - 当前执行sql:
          SELECT param_code, param_state, param_value
          FROM water_revenue.sys_param
          WHERE param_code IN ('0125', '0126')           
2025-10-26 15:10:00,640 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '2'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '3'}]
2025-10-26 15:10:00,641 - INFO - 远传出账取数时间范围正确√
2025-10-26 15:10:01,153 - INFO - 当前执行sql:
    select cal_day,is_work_day,work_day_seq,is_make_day from water_revenue.calendar_date where cal_day like '2025-11%' order by cal_day ;
    
2025-10-26 15:10:01,155 - INFO - SQL执行结果:[{'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}]
2025-10-26 15:10:01,159 - ERROR - 约束1失败: 日期 '01' 不等于 work_day_seq 'None'
2025-10-26 15:10:01,160 - ERROR - 工作日与户表开账日配置错误，需要调整
2025-10-26 15:10:01,161 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【系统参数0125/0126】远传出账取数时间范围正确√\n【计划管理】工作日与户表开账日配置错误，需要调整\n"}]
2025-10-26 15:10:02,298 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-26 15:10:02,299 - INFO - SQL执行结果:[{'count': 139931, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 135384, 'seq': 3}]
2025-10-26 15:10:02,300 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期查表计划数量(支)': 139931, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 135384}}
2025-10-26 15:10:02,868 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-26 15:10:02,869 - INFO - SQL执行结果:[{'count': 53584, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 41384, 'seq': 3}]
2025-10-26 15:10:02,870 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期查表计划数量(支)': 53584, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 41384}}
2025-10-26 15:10:02,871 - INFO - 【生产环境】查表计划当前生成情况：
石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384
长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384
2025-10-26 15:10:02,872 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【生产环境】查表计划当前生成情况：\n石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384\n长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384"}]
2025-10-26 15:10:22,231 - ERROR - HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001B6260F6170>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1038, in _send_output
    self.send(msg)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 976, in send
    self.connect()
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connection.py", line 207, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPConnection object at 0x000001B6260F6170>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001B6260F6170>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\orchestrator\executor.py", line 129, in run
    flowing_data = await _execute_task(task, flowing_data, pipeline_params)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\orchestrator\executor.py", line 195, in _execute_task
    result = await task.run(*args, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\pipeline\__init__.py", line 22, in wrapper_decorator
    value = await asyncio.to_thread(func, *args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\check_config.py", line 194, in check_config_job
    sms_client.send_sms(phones=job_config['phones'],content=message,logger=logger)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\sms\sms_client.py", line 26, in send_sms
    resp = requests.post(self.base_url, json=paramList)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\adapters.py", line 665, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001B6260F6170>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
2025-10-26 15:10:22,267 - INFO - Job "check: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 15:15:00 CST)" executed successfully
2025-10-26 15:10:23,902 - ERROR - HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001B6261805B0>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1038, in _send_output
    self.send(msg)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 976, in send
    self.connect()
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connection.py", line 207, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPConnection object at 0x000001B6261805B0>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001B6261805B0>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\orchestrator\executor.py", line 129, in run
    flowing_data = await _execute_task(task, flowing_data, pipeline_params)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\orchestrator\executor.py", line 195, in _execute_task
    result = await task.run(*args, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\pipeline\__init__.py", line 22, in wrapper_decorator
    value = await asyncio.to_thread(func, *args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\fetch_trans_data.py", line 94, in run_fetch_wmr_pro
    sms_client.send_sms(phones=job_config['phones'],content=message,logger=logger)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\sms\sms_client.py", line 26, in send_sms
    resp = requests.post(self.base_url, json=paramList)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\adapters.py", line 665, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001B6261805B0>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
2025-10-26 15:10:23,914 - INFO - Job "fetch: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 15:15:00 CST)" executed successfully
2025-10-26 15:15:00,025 - INFO - Running job "check: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 15:20:00 CST)" (scheduled at 2025-10-26 15:15:00+08:00)
2025-10-26 15:15:00,039 - INFO - Executing pipeline `check` #18 via trigger `daily`
2025-10-26 15:15:00,041 - INFO - Executing task check_config_job
2025-10-26 15:15:00,042 - INFO - Running job "fetch: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 15:20:00 CST)" (scheduled at 2025-10-26 15:15:00+08:00)
2025-10-26 15:15:00,056 - INFO - Executing pipeline `fetch` #19 via trigger `daily`
2025-10-26 15:15:00,058 - INFO - Executing task run_fetch_wmr_pro
2025-10-26 15:15:01,152 - INFO - 当前执行sql:
          SELECT param_code, param_state, param_value
          FROM water_revenue.sys_param
          WHERE param_code IN ('0125', '0126')           
2025-10-26 15:15:01,153 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '2'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '3'}]
2025-10-26 15:15:01,154 - INFO - 远传出账取数时间范围正确√
2025-10-26 15:15:01,798 - INFO - 当前执行sql:
    select cal_day,is_work_day,work_day_seq,is_make_day from water_revenue.calendar_date where cal_day like '2025-11%' order by cal_day ;
    
2025-10-26 15:15:01,800 - INFO - SQL执行结果:[{'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}]
2025-10-26 15:15:01,801 - ERROR - 约束1失败: 日期 '01' 不等于 work_day_seq 'None'
2025-10-26 15:15:01,802 - ERROR - 工作日与户表开账日配置错误，需要调整
2025-10-26 15:15:01,803 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【系统参数0125/0126】远传出账取数时间范围正确√\n【计划管理】工作日与户表开账日配置错误，需要调整\n"}]
2025-10-26 15:15:02,637 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-26 15:15:02,638 - INFO - SQL执行结果:[{'count': 139931, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 135384, 'seq': 3}]
2025-10-26 15:15:02,638 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期查表计划数量(支)': 139931, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 135384}}
2025-10-26 15:15:03,280 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-26 15:15:03,281 - INFO - SQL执行结果:[{'count': 53584, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 41384, 'seq': 3}]
2025-10-26 15:15:03,282 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期查表计划数量(支)': 53584, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 41384}}
2025-10-26 15:15:03,283 - INFO - 【生产环境】查表计划当前生成情况：
石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384
长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384
2025-10-26 15:15:03,284 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【生产环境】查表计划当前生成情况：\n石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384\n长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384"}]
2025-10-26 15:15:22,846 - ERROR - HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001B626181780>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1038, in _send_output
    self.send(msg)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 976, in send
    self.connect()
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connection.py", line 207, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPConnection object at 0x000001B626181780>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001B626181780>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\orchestrator\executor.py", line 129, in run
    flowing_data = await _execute_task(task, flowing_data, pipeline_params)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\orchestrator\executor.py", line 195, in _execute_task
    result = await task.run(*args, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\pipeline\__init__.py", line 22, in wrapper_decorator
    value = await asyncio.to_thread(func, *args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\check_config.py", line 194, in check_config_job
    sms_client.send_sms(phones=job_config['phones'],content=message,logger=logger)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\sms\sms_client.py", line 26, in send_sms
    resp = requests.post(self.base_url, json=paramList)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\adapters.py", line 665, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001B626181780>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
2025-10-26 15:15:22,866 - INFO - Job "check: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 15:20:00 CST)" executed successfully
2025-10-26 15:15:24,323 - ERROR - HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001B626180250>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1038, in _send_output
    self.send(msg)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 976, in send
    self.connect()
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connection.py", line 207, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPConnection object at 0x000001B626180250>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001B626180250>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\orchestrator\executor.py", line 129, in run
    flowing_data = await _execute_task(task, flowing_data, pipeline_params)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\orchestrator\executor.py", line 195, in _execute_task
    result = await task.run(*args, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\plombery\pipeline\__init__.py", line 22, in wrapper_decorator
    value = await asyncio.to_thread(func, *args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\fetch_trans_data.py", line 94, in run_fetch_wmr_pro
    sms_client.send_sms(phones=job_config['phones'],content=message,logger=logger)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\run\src\sms\sms_client.py", line 26, in send_sms
    resp = requests.post(self.base_url, json=paramList)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "C:\Users\BT0624\PycharmProjects\plombery-chn\.venv\lib\site-packages\requests\adapters.py", line 665, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001B626180250>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
2025-10-26 15:15:24,336 - INFO - Job "fetch: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 15:20:00 CST)" executed successfully
2025-10-26 16:55:47,657 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 16:55:47,659 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 16:56:08,158 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 16:56:08,165 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 16:56:09,472 - INFO - Added job "check: daily" to job store "default"
2025-10-26 16:56:09,477 - INFO - Added job "fetch: daily" to job store "default"
2025-10-26 16:56:09,479 - INFO - Scheduler started
2025-10-26 17:05:28,059 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
order by seq

2025-10-26 17:05:28,062 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}]
2025-10-26 17:05:28,062 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期户表已出账(支)': 79765, '本周期户表应出账(支)': 84022, '本周期大路表已出账(支)': 732, '本周期大路表应出账(支)': 3804}}
2025-10-26 17:05:32,225 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
order by seq

2025-10-26 17:05:32,226 - INFO - SQL执行结果:[{'count': 41937, 'seq': 1}, {'count': 43003, 'seq': 2}, {'count': 169, 'seq': 3}, {'count': 1209, 'seq': 4}]
2025-10-26 17:05:32,226 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期户表已出账(支)': 41937, '本周期户表应出账(支)': 43003, '本周期大路表已出账(支)': 169, '本周期大路表应出账(支)': 1209}}
2025-10-26 17:05:32,227 - INFO - 【生产环境】截至目前本月远传出账情况：
石景山:本周期户表已出账(支): 79765, 本周期户表应出账(支): 84022, 本周期大路表已出账(支): 732, 本周期大路表应出账(支): 3804
长辛店:本周期户表已出账(支): 41937, 本周期户表应出账(支): 43003, 本周期大路表已出账(支): 169, 本周期大路表应出账(支): 1209
2025-10-26 17:05:32,227 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【生产环境】截至目前本月远传出账情况：\n石景山:本周期户表已出账(支): 79765, 本周期户表应出账(支): 84022, 本周期大路表已出账(支): 732, 本周期大路表应出账(支): 3804\n长辛店:本周期户表已出账(支): 41937, 本周期户表应出账(支): 43003, 本周期大路表已出账(支): 169, 本周期大路表应出账(支): 1209"}]
2025-10-26 17:06:34,257 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 17:06:34,258 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 17:06:37,253 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 17:06:37,254 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 17:06:37,369 - INFO - Added job "check: daily" to job store "default"
2025-10-26 17:06:37,370 - INFO - Added job "fetch: daily" to job store "default"
2025-10-26 17:06:37,370 - INFO - Scheduler started
2025-10-26 17:08:05,779 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 17:08:05,780 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 17:08:08,667 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 17:08:08,669 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 17:08:08,794 - INFO - Added job "check: daily" to job store "default"
2025-10-26 17:08:08,796 - INFO - Added job "fetch: daily" to job store "default"
2025-10-26 17:08:08,796 - INFO - Scheduler started
2025-10-26 17:09:31,127 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 17:09:31,129 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 17:09:34,078 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 17:09:34,079 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 17:09:34,192 - INFO - Added job "check: daily" to job store "default"
2025-10-26 17:09:34,194 - INFO - Added job "fetch: daily" to job store "default"
2025-10-26 17:09:34,194 - INFO - Scheduler started
2025-10-26 17:10:00,013 - INFO - Running job "check: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 17:15:00 CST)" (scheduled at 2025-10-26 17:10:00+08:00)
2025-10-26 17:10:00,037 - INFO - Executing pipeline `check` #20 via trigger `daily`
2025-10-26 17:10:00,039 - INFO - Executing task check_config_job
2025-10-26 17:10:00,041 - INFO - Running job "fetch: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 17:15:00 CST)" (scheduled at 2025-10-26 17:10:00+08:00)
2025-10-26 17:10:00,056 - INFO - Executing pipeline `fetch` #21 via trigger `daily`
2025-10-26 17:10:00,057 - INFO - Executing task fetch_plan_data_job
2025-10-26 17:10:00,536 - INFO - 当前执行sql:
          SELECT param_code, param_state, param_value
          FROM water_revenue.sys_param
          WHERE param_code IN ('0125', '0126')           
2025-10-26 17:10:00,537 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '2'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '3'}]
2025-10-26 17:10:00,537 - INFO - 远传出账取数时间范围正确√
2025-10-26 17:10:01,149 - INFO - 当前执行sql:
    select cal_day,is_work_day,work_day_seq,is_make_day from water_revenue.calendar_date where cal_day like '2025-11%' order by cal_day ;
    
2025-10-26 17:10:01,150 - INFO - SQL执行结果:[{'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}]
2025-10-26 17:10:01,152 - ERROR - 约束1失败: 日期 '01' 不等于 work_day_seq 'None'
2025-10-26 17:10:01,153 - ERROR - 工作日与户表开账日配置错误，需要调整
2025-10-26 17:10:01,154 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【系统参数0125/0126】远传出账取数时间范围正确√\n【计划管理】工作日与户表开账日配置错误，需要调整\n"}]
2025-10-26 17:10:02,053 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-26 17:10:02,054 - INFO - SQL执行结果:[{'count': 139931, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 135384, 'seq': 3}]
2025-10-26 17:10:02,056 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期查表计划数量(支)': 139931, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 135384}}
2025-10-26 17:10:02,629 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-26 17:10:02,630 - INFO - SQL执行结果:[{'count': 53584, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 41384, 'seq': 3}]
2025-10-26 17:10:02,631 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期查表计划数量(支)': 53584, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 41384}}
2025-10-26 17:10:02,631 - INFO - 【生产环境】查表计划当前生成情况：
石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384
长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384
2025-10-26 17:10:02,633 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【生产环境】查表计划当前生成情况：\n石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384\n长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384"}]
2025-10-26 17:10:22,205 - ERROR - HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001D360E957E0>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1038, in _send_output
    self.send(msg)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 976, in send
    self.connect()
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 207, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPConnection object at 0x000001D360E957E0>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001D360E957E0>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\orchestrator\executor.py", line 129, in run
    flowing_data = await _execute_task(task, flowing_data, pipeline_params)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\orchestrator\executor.py", line 195, in _execute_task
    result = await task.run(*args, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\pipeline\__init__.py", line 22, in wrapper_decorator
    value = await asyncio.to_thread(func, *args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\BT0624\PycharmProjects\plomebery-tools\run\src\check_config.py", line 194, in check_config_job
    sms_client.send_sms(phones=job_config['phones'],content=message,logger=logger)
  File "C:\Users\BT0624\PycharmProjects\plomebery-tools\run\src\sms\sms_client.py", line 26, in send_sms
    resp = requests.post(self.base_url, json=paramList)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\adapters.py", line 665, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001D360E957E0>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
2025-10-26 17:10:22,239 - INFO - Job "check: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 17:15:00 CST)" executed successfully
2025-10-26 17:10:23,667 - ERROR - HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001D361214730>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1038, in _send_output
    self.send(msg)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 976, in send
    self.connect()
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 207, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPConnection object at 0x000001D361214730>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001D361214730>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\orchestrator\executor.py", line 129, in run
    flowing_data = await _execute_task(task, flowing_data, pipeline_params)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\orchestrator\executor.py", line 195, in _execute_task
    result = await task.run(*args, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\pipeline\__init__.py", line 22, in wrapper_decorator
    value = await asyncio.to_thread(func, *args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\BT0624\PycharmProjects\plomebery-tools\run\src\fetch_plan_data.py", line 94, in fetch_plan_data_job
    sms_client.send_sms(phones=job_config['phones'],content=message,logger=logger)
  File "C:\Users\BT0624\PycharmProjects\plomebery-tools\run\src\sms\sms_client.py", line 26, in send_sms
    resp = requests.post(self.base_url, json=paramList)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\adapters.py", line 665, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001D361214730>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
2025-10-26 17:10:23,690 - INFO - Job "fetch: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 17:15:00 CST)" executed successfully
2025-10-26 17:15:00,026 - INFO - Running job "check: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 17:20:00 CST)" (scheduled at 2025-10-26 17:15:00+08:00)
2025-10-26 17:15:00,052 - INFO - Executing pipeline `check` #22 via trigger `daily`
2025-10-26 17:15:00,054 - INFO - Executing task check_config_job
2025-10-26 17:15:00,058 - INFO - Running job "fetch: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 17:20:00 CST)" (scheduled at 2025-10-26 17:15:00+08:00)
2025-10-26 17:15:00,087 - INFO - Executing pipeline `fetch` #23 via trigger `daily`
2025-10-26 17:15:00,090 - INFO - Executing task fetch_plan_data_job
2025-10-26 17:15:00,587 - INFO - 当前执行sql:
          SELECT param_code, param_state, param_value
          FROM water_revenue.sys_param
          WHERE param_code IN ('0125', '0126')           
2025-10-26 17:15:00,589 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '2'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '3'}]
2025-10-26 17:15:00,591 - INFO - 远传出账取数时间范围正确√
2025-10-26 17:15:01,028 - INFO - 当前执行sql:
    select cal_day,is_work_day,work_day_seq,is_make_day from water_revenue.calendar_date where cal_day like '2025-11%' order by cal_day ;
    
2025-10-26 17:15:01,030 - INFO - SQL执行结果:[{'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}]
2025-10-26 17:15:01,034 - ERROR - 约束1失败: 日期 '01' 不等于 work_day_seq 'None'
2025-10-26 17:15:01,036 - ERROR - 工作日与户表开账日配置错误，需要调整
2025-10-26 17:15:01,039 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【系统参数0125/0126】远传出账取数时间范围正确√\n【计划管理】工作日与户表开账日配置错误，需要调整\n"}]
2025-10-26 17:15:02,063 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-26 17:15:02,067 - INFO - SQL执行结果:[{'count': 139931, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 135384, 'seq': 3}]
2025-10-26 17:15:02,073 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期查表计划数量(支)': 139931, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 135384}}
2025-10-26 17:15:02,679 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-26 17:15:02,682 - INFO - SQL执行结果:[{'count': 53584, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 41384, 'seq': 3}]
2025-10-26 17:15:02,684 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期查表计划数量(支)': 53584, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 41384}}
2025-10-26 17:15:02,686 - INFO - 【生产环境】查表计划当前生成情况：
石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384
长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384
2025-10-26 17:15:02,690 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【生产环境】查表计划当前生成情况：\n石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384\n长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384"}]
2025-10-26 17:15:22,101 - ERROR - HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001D361216260>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1038, in _send_output
    self.send(msg)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 976, in send
    self.connect()
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 207, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPConnection object at 0x000001D361216260>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001D361216260>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\orchestrator\executor.py", line 129, in run
    flowing_data = await _execute_task(task, flowing_data, pipeline_params)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\orchestrator\executor.py", line 195, in _execute_task
    result = await task.run(*args, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\pipeline\__init__.py", line 22, in wrapper_decorator
    value = await asyncio.to_thread(func, *args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\BT0624\PycharmProjects\plomebery-tools\run\src\check_config.py", line 194, in check_config_job
    sms_client.send_sms(phones=job_config['phones'],content=message,logger=logger)
  File "C:\Users\BT0624\PycharmProjects\plomebery-tools\run\src\sms\sms_client.py", line 26, in send_sms
    resp = requests.post(self.base_url, json=paramList)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\adapters.py", line 665, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001D361216260>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
2025-10-26 17:15:22,196 - INFO - Job "check: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 17:20:00 CST)" executed successfully
2025-10-26 17:15:24,002 - ERROR - HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001D3612169E0>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1038, in _send_output
    self.send(msg)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 976, in send
    self.connect()
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 207, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPConnection object at 0x000001D3612169E0>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001D3612169E0>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\orchestrator\executor.py", line 129, in run
    flowing_data = await _execute_task(task, flowing_data, pipeline_params)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\orchestrator\executor.py", line 195, in _execute_task
    result = await task.run(*args, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\pipeline\__init__.py", line 22, in wrapper_decorator
    value = await asyncio.to_thread(func, *args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\BT0624\PycharmProjects\plomebery-tools\run\src\fetch_plan_data.py", line 94, in fetch_plan_data_job
    sms_client.send_sms(phones=job_config['phones'],content=message,logger=logger)
  File "C:\Users\BT0624\PycharmProjects\plomebery-tools\run\src\sms\sms_client.py", line 26, in send_sms
    resp = requests.post(self.base_url, json=paramList)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\adapters.py", line 665, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001D3612169E0>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
2025-10-26 17:15:24,060 - INFO - Job "fetch: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 17:20:00 CST)" executed successfully
2025-10-26 17:17:22,288 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 17:17:22,290 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 17:17:41,182 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 17:17:41,187 - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-26 17:17:42,271 - INFO - Added job "check: daily" to job store "default"
2025-10-26 17:17:42,276 - INFO - Added job "fetch: daily" to job store "default"
2025-10-26 17:17:42,278 - INFO - Scheduler started
2025-10-26 17:20:00,002 - INFO - Running job "check: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 17:25:00 CST)" (scheduled at 2025-10-26 17:20:00+08:00)
2025-10-26 17:20:00,030 - INFO - Executing pipeline `check` #24 via trigger `daily`
2025-10-26 17:20:00,032 - INFO - Executing task check_config_job
2025-10-26 17:20:00,035 - INFO - Running job "fetch: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 17:25:00 CST)" (scheduled at 2025-10-26 17:20:00+08:00)
2025-10-26 17:20:00,054 - INFO - Executing pipeline `fetch` #25 via trigger `daily`
2025-10-26 17:20:00,056 - INFO - Executing task fetch_plan_data_job
2025-10-26 17:20:00,546 - INFO - 当前执行sql:
          SELECT param_code, param_state, param_value
          FROM water_revenue.sys_param
          WHERE param_code IN ('0125', '0126')           
2025-10-26 17:20:00,550 - INFO - SQL执行结果:[{'param_code': '0125', 'param_state': 'Y', 'param_value': '2'}, {'param_code': '0126', 'param_state': 'Y', 'param_value': '3'}]
2025-10-26 17:20:00,552 - INFO - 远传出账取数时间范围正确√
2025-10-26 17:20:01,030 - INFO - 当前执行sql:
    select cal_day,is_work_day,work_day_seq,is_make_day from water_revenue.calendar_date where cal_day like '2025-11%' order by cal_day ;
    
2025-10-26 17:20:01,031 - INFO - SQL执行结果:[{'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-01', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-02', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-03', 'is_work_day': '0', 'work_day_seq': 1, 'is_make_day': 'Y'}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-04', 'is_work_day': '0', 'work_day_seq': 2, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-05', 'is_work_day': '0', 'work_day_seq': 3, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-06', 'is_work_day': '0', 'work_day_seq': 4, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-07', 'is_work_day': '0', 'work_day_seq': 5, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-08', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-09', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-10', 'is_work_day': '0', 'work_day_seq': 6, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-11', 'is_work_day': '0', 'work_day_seq': 7, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-12', 'is_work_day': '0', 'work_day_seq': 8, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-13', 'is_work_day': '0', 'work_day_seq': 9, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-14', 'is_work_day': '0', 'work_day_seq': 10, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-15', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-16', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-17', 'is_work_day': '0', 'work_day_seq': 11, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-18', 'is_work_day': '0', 'work_day_seq': 12, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-19', 'is_work_day': '0', 'work_day_seq': 13, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-20', 'is_work_day': '0', 'work_day_seq': 14, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-21', 'is_work_day': '0', 'work_day_seq': 15, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-22', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-23', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-24', 'is_work_day': '0', 'work_day_seq': 16, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-25', 'is_work_day': '0', 'work_day_seq': 17, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-26', 'is_work_day': '0', 'work_day_seq': 18, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-27', 'is_work_day': '0', 'work_day_seq': 19, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-28', 'is_work_day': '0', 'work_day_seq': 20, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-29', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}, {'cal_day': '2025-11-30', 'is_work_day': '1', 'work_day_seq': None, 'is_make_day': None}]
2025-10-26 17:20:01,037 - ERROR - 约束1失败: 日期 '01' 不等于 work_day_seq 'None'
2025-10-26 17:20:01,038 - ERROR - 工作日与户表开账日配置错误，需要调整
2025-10-26 17:20:01,040 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【系统参数0125/0126】远传出账取数时间范围正确√\n【计划管理】工作日与户表开账日配置错误，需要调整\n"}]
2025-10-26 17:20:01,998 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-26 17:20:01,999 - INFO - SQL执行结果:[{'count': 139931, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 135384, 'seq': 3}]
2025-10-26 17:20:02,000 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期查表计划数量(支)': 139931, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 135384}}
2025-10-26 17:20:02,500 - INFO - 当前执行sql:select count(*) ,1 as seq from water_revenue.water_meter_read
union all
select count(*) ,2 as seq from water_revenue.water_meter_read_his_2025 where  mr_month = '2025-09'
union all
select count(*) ,3 as seq from water_revenue.water_meter_read_his_2024 where mr_month = '2024-10'
order by seq

2025-10-26 17:20:02,502 - INFO - SQL执行结果:[{'count': 53584, 'seq': 1}, {'count': 0, 'seq': 2}, {'count': 41384, 'seq': 3}]
2025-10-26 17:20:02,504 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期查表计划数量(支)': 53584, '上周期查表计划数量(支)': 0, '去年同期查表计划数量(支)': 41384}}
2025-10-26 17:20:02,505 - INFO - 【生产环境】查表计划当前生成情况：
石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384
长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384
2025-10-26 17:20:02,507 - INFO - post:http://172.16.14.15:8099/sharding/message/batchSend?account=3564001,参数:[{"phones": "15671669511,17371694776", "content": "【生产环境】查表计划当前生成情况：\n石景山:本周期查表计划数量(支): 139931, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 135384\n长辛店:本周期查表计划数量(支): 53584, 上周期查表计划数量(支): 0, 去年同期查表计划数量(支): 41384"}]
2025-10-26 17:20:22,087 - ERROR - HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000002420E295390>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1038, in _send_output
    self.send(msg)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 976, in send
    self.connect()
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 207, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPConnection object at 0x000002420E295390>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000002420E295390>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\orchestrator\executor.py", line 129, in run
    flowing_data = await _execute_task(task, flowing_data, pipeline_params)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\orchestrator\executor.py", line 195, in _execute_task
    result = await task.run(*args, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\pipeline\__init__.py", line 22, in wrapper_decorator
    value = await asyncio.to_thread(func, *args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\BT0624\PycharmProjects\plomebery-tools\run\src\check_config.py", line 194, in check_config_job
    sms_client.send_sms(phones=job_config['phones'],content=message,logger=logger)
  File "C:\Users\BT0624\PycharmProjects\plomebery-tools\run\src\sms\sms_client.py", line 26, in send_sms
    resp = requests.post(self.base_url, json=paramList)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\adapters.py", line 665, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000002420E295390>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
2025-10-26 17:20:22,136 - INFO - Job "check: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 17:25:00 CST)" executed successfully
2025-10-26 17:20:23,564 - ERROR - HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000002420E295B70>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
TimeoutError: [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 493, in _make_request
    conn.request(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 494, in request
    self.endheaders()
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 1038, in _send_output
    self.send(msg)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\http\client.py", line 976, in send
    self.connect()
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 325, in connect
    self.sock = self._new_conn()
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connection.py", line 207, in _new_conn
    raise ConnectTimeoutError(
urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPConnection object at 0x000002420E295B70>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000002420E295B70>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\orchestrator\executor.py", line 129, in run
    flowing_data = await _execute_task(task, flowing_data, pipeline_params)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\orchestrator\executor.py", line 195, in _execute_task
    result = await task.run(*args, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\plombery\pipeline\__init__.py", line 22, in wrapper_decorator
    value = await asyncio.to_thread(func, *args, **kwargs)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\asyncio\threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.10_3.10.3056.0_x64__qbz5n2kfra8p0\lib\concurrent\futures\thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\BT0624\PycharmProjects\plomebery-tools\run\src\fetch_plan_data.py", line 94, in fetch_plan_data_job
    sms_client.send_sms(phones=job_config['phones'],content=message,logger=logger)
  File "C:\Users\BT0624\PycharmProjects\plomebery-tools\run\src\sms\sms_client.py", line 26, in send_sms
    resp = requests.post(self.base_url, json=paramList)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "C:\Users\BT0624\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\requests\adapters.py", line 665, in send
    raise ConnectTimeout(e, request=request)
requests.exceptions.ConnectTimeout: HTTPConnectionPool(host='172.16.14.15', port=8099): Max retries exceeded with url: /sharding/message/batchSend?account=3564001 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000002420E295B70>, 'Connection to 172.16.14.15 timed out. (connect timeout=None)'))
2025-10-26 17:20:23,591 - INFO - Job "fetch: daily (trigger: cron[month='*', day='*', day_of_week='*', hour='*', minute='*/5'], next run at: 2025-10-26 17:25:00 CST)" executed successfully
2025-10-31 10:43:02,667 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31 '
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 10:43:02,669 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 74697, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 1058, 'seq': 8}]
2025-10-31 10:43:22,599 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31 '
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 10:43:22,599 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 74697, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 1058, 'seq': 8}]
2025-10-31 10:43:22,599 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期户表出账(支)': 79765, '本周期户表应出账(支)': 84022, '本周期大路表出账(支)': 732, '本周期大路表应出账(支)': 3804, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 74697, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 1058}}
2025-10-31 10:43:22,600 - ERROR - 模板文件未找到: /template/远传出账明细模板.xlsx。请确保模板存在。
2025-10-31 10:43:22,601 - ERROR - 获取 CompanyNameEnum.DS_SJS 数据失败: <CompanyNameEnum.DS_SJS: '石景山'>
2025-10-31 10:43:22,601 - ERROR - 生成 Excel 出现错误: Cannot convert <CompanyNameEnum.DS_SJS: '石景山'> to Excel
2025-10-31 10:43:49,322 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31 '
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 10:43:49,322 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 74697, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 1058, 'seq': 8}]
2025-10-31 10:43:49,322 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期户表出账(支)': 79765, '本周期户表应出账(支)': 84022, '本周期大路表出账(支)': 732, '本周期大路表应出账(支)': 3804, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 74697, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 1058}}
2025-10-31 10:43:49,323 - ERROR - 模板文件未找到: template/远传出账明细模板.xlsx。请确保模板存在。
2025-10-31 10:43:49,324 - ERROR - 获取 CompanyNameEnum.DS_SJS 数据失败: <CompanyNameEnum.DS_SJS: '石景山'>
2025-10-31 10:43:49,324 - ERROR - 生成 Excel 出现错误: Cannot convert <CompanyNameEnum.DS_SJS: '石景山'> to Excel
2025-10-31 10:49:34,552 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31 '
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 10:49:34,554 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 74697, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 1058, 'seq': 8}]
2025-10-31 10:49:34,555 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期户表出账(支)': 79765, '本周期户表应出账(支)': 84022, '本周期大路表出账(支)': 732, '本周期大路表应出账(支)': 3804, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 74697, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 1058}}
2025-10-31 10:49:34,555 - ERROR - 模板文件未找到: template/远传出账明细模板.xlsx。请确保模板存在。
2025-10-31 10:49:34,556 - ERROR - 获取 CompanyNameEnum.DS_SJS 数据失败: <CompanyNameEnum.DS_SJS: '石景山'>
2025-10-31 10:49:34,556 - ERROR - 生成 Excel 出现错误: Cannot convert <CompanyNameEnum.DS_SJS: '石景山'> to Excel
2025-10-31 10:50:03,310 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31 '
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 10:50:03,311 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 74697, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 1058, 'seq': 8}]
2025-10-31 10:50:03,311 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期户表出账(支)': 79765, '本周期户表应出账(支)': 84022, '本周期大路表出账(支)': 732, '本周期大路表应出账(支)': 3804, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 74697, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 1058}}
2025-10-31 10:50:03,311 - ERROR - 模板文件未找到: src/template/远传出账明细模板.xlsx。请确保模板存在。
2025-10-31 10:50:03,312 - ERROR - 获取 CompanyNameEnum.DS_SJS 数据失败: <CompanyNameEnum.DS_SJS: '石景山'>
2025-10-31 10:50:03,312 - ERROR - 生成 Excel 出现错误: Cannot convert <CompanyNameEnum.DS_SJS: '石景山'> to Excel
2025-10-31 10:50:38,854 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31 '
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 10:50:38,855 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 74697, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 1058, 'seq': 8}]
2025-10-31 10:50:38,855 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期户表出账(支)': 79765, '本周期户表应出账(支)': 84022, '本周期大路表出账(支)': 732, '本周期大路表应出账(支)': 3804, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 74697, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 1058}}
2025-10-31 10:50:38,855 - ERROR - 模板文件未找到: src/template/远传出账明细.xlsx。请确保模板存在。
2025-10-31 10:50:38,856 - ERROR - 获取 CompanyNameEnum.DS_SJS 数据失败: <CompanyNameEnum.DS_SJS: '石景山'>
2025-10-31 10:50:38,856 - ERROR - 生成 Excel 出现错误: Cannot convert <CompanyNameEnum.DS_SJS: '石景山'> to Excel
2025-10-31 10:51:13,196 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31 '
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 10:51:13,197 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 74697, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 1058, 'seq': 8}]
2025-10-31 10:51:13,197 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期户表出账(支)': 79765, '本周期户表应出账(支)': 84022, '本周期大路表出账(支)': 732, '本周期大路表应出账(支)': 3804, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 74697, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 1058}}
2025-10-31 10:51:13,197 - ERROR - 模板文件未找到: src/template/远传出账明细.xlsx。请确保模板存在。
2025-10-31 10:51:13,198 - ERROR - 获取 CompanyNameEnum.DS_SJS 数据失败: <CompanyNameEnum.DS_SJS: '石景山'>
2025-10-31 10:51:13,198 - ERROR - 生成 Excel 出现错误: Cannot convert <CompanyNameEnum.DS_SJS: '石景山'> to Excel
2025-10-31 10:51:44,163 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31 '
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 10:51:44,163 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 74697, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 1058, 'seq': 8}]
2025-10-31 10:51:44,164 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期户表出账(支)': 79765, '本周期户表应出账(支)': 84022, '本周期大路表出账(支)': 732, '本周期大路表应出账(支)': 3804, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 74697, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 1058}}
2025-10-31 10:51:44,164 - ERROR - 模板文件未找到: /run/src/template/远传出账明细.xlsx。请确保模板存在。
2025-10-31 10:51:44,165 - ERROR - 获取 CompanyNameEnum.DS_SJS 数据失败: <CompanyNameEnum.DS_SJS: '石景山'>
2025-10-31 10:51:44,165 - ERROR - 生成 Excel 出现错误: Cannot convert <CompanyNameEnum.DS_SJS: '石景山'> to Excel
2025-10-31 10:59:34,260 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31 '
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 10:59:34,260 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 74697, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 1058, 'seq': 8}]
2025-10-31 10:59:34,260 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期户表出账(支)': 79765, '本周期户表应出账(支)': 84022, '本周期大路表出账(支)': 732, '本周期大路表应出账(支)': 3804, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 74697, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 1058}}
2025-10-31 10:59:34,260 - ERROR - 模板文件未找到: D:\PycharmProjects\plomebery-tools\run\src\template\远传出账明细.xlsx。请确保模板存在。
2025-10-31 10:59:34,261 - ERROR - 获取 CompanyNameEnum.DS_SJS 数据失败: <CompanyNameEnum.DS_SJS: '石景山'>
2025-10-31 10:59:34,261 - ERROR - 生成 Excel 出现错误: Cannot convert <CompanyNameEnum.DS_SJS: '石景山'> to Excel
2025-10-31 11:00:24,187 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31 '
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 11:00:24,187 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 74697, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 1058, 'seq': 8}]
2025-10-31 11:00:24,187 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期户表出账(支)': 79765, '本周期户表应出账(支)': 84022, '本周期大路表出账(支)': 732, '本周期大路表应出账(支)': 3804, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 74697, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 1058}}
2025-10-31 11:00:24,203 - ERROR - 获取 CompanyNameEnum.DS_SJS 数据失败: <CompanyNameEnum.DS_SJS: '石景山'>
2025-10-31 11:00:24,203 - ERROR - 生成 Excel 出现错误: Cannot convert <CompanyNameEnum.DS_SJS: '石景山'> to Excel
2025-10-31 11:07:04,947 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31 '
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 11:07:04,948 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 74697, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 1058, 'seq': 8}]
2025-10-31 11:07:04,949 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期户表出账(支)': 79765, '本周期户表应出账(支)': 84022, '本周期大路表出账(支)': 732, '本周期大路表应出账(支)': 3804, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 74697, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 1058}}
2025-10-31 11:07:27,802 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31 '
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 11:07:27,802 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 74697, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 1058, 'seq': 8}]
2025-10-31 11:07:27,803 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期户表出账(支)': 79765, '本周期户表应出账(支)': 84022, '本周期大路表出账(支)': 732, '本周期大路表应出账(支)': 3804, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 74697, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 1058}}
2025-10-31 11:07:27,814 - INFO - 已将 ds_sjs 数据写入 Excel 第 2 列 (B列)。
2025-10-31 11:07:27,830 - INFO - Excel 文件已成功生成并保存到: 远传表出账明细.xlsx
2025-10-31 11:09:56,666 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31 '
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 11:09:56,667 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 74697, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 1058, 'seq': 8}]
2025-10-31 11:09:56,667 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期户表出账(支)': 79765, '本周期户表应出账(支)': 84022, '本周期大路表出账(支)': 732, '本周期大路表应出账(支)': 3804, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 74697, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 1058}}
2025-10-31 11:09:56,682 - INFO - 已将 石景山 数据写入 Excel 第 2 列 (B列)。
2025-10-31 11:09:56,682 - ERROR - 生成 Excel 出现错误: [Errno 13] Permission denied: '远传表出账明细.xlsx'
2025-10-31 11:10:11,654 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31 '
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 11:10:11,655 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 74697, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 1058, 'seq': 8}]
2025-10-31 11:10:11,655 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期户表出账(支)': 79765, '本周期户表应出账(支)': 84022, '本周期大路表出账(支)': 732, '本周期大路表应出账(支)': 3804, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 74697, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 1058}}
2025-10-31 11:10:11,668 - INFO - 已将 石景山 数据写入 Excel 第 2 列 (B列)。
2025-10-31 11:10:11,681 - INFO - Excel 文件已成功生成并保存到: 远传表出账明细.xlsx
2025-10-31 11:10:31,500 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31 '
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 11:10:31,500 - INFO - SQL执行结果:[{'count': 41937, 'seq': 1}, {'count': 43003, 'seq': 2}, {'count': 169, 'seq': 3}, {'count': 1209, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 879, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 67, 'seq': 8}]
2025-10-31 11:10:31,500 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期户表出账(支)': 41937, '本周期户表应出账(支)': 43003, '本周期大路表出账(支)': 169, '本周期大路表应出账(支)': 1209, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 879, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 67}}
2025-10-31 11:10:31,519 - INFO - 已将 长辛店 数据写入 Excel 第 2 列 (B列)。
2025-10-31 11:10:31,519 - ERROR - 生成 Excel 出现错误: [Errno 13] Permission denied: '远传表出账明细.xlsx'
2025-10-31 11:11:39,624 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31'
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 11:11:39,624 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 74697, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 1058, 'seq': 8}]
2025-10-31 11:11:39,624 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期户表出账(支)': 79765, '本周期户表应出账(支)': 84022, '本周期大路表出账(支)': 732, '本周期大路表应出账(支)': 3804, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 74697, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 1058}}
2025-10-31 11:11:39,637 - INFO - 已将 石景山 数据写入 Excel 第 2 列 (B列)。
2025-10-31 11:11:39,652 - INFO - Excel 文件已成功生成并保存到: 远传表出账明细.xlsx
2025-10-31 11:11:40,143 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31'
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 11:11:40,143 - INFO - SQL执行结果:[{'count': 41937, 'seq': 1}, {'count': 43003, 'seq': 2}, {'count': 169, 'seq': 3}, {'count': 1209, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 879, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 67, 'seq': 8}]
2025-10-31 11:11:40,143 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期户表出账(支)': 41937, '本周期户表应出账(支)': 43003, '本周期大路表出账(支)': 169, '本周期大路表应出账(支)': 1209, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 879, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 67}}
2025-10-31 11:11:40,158 - INFO - 已将 长辛店 数据写入 Excel 第 2 列 (B列)。
2025-10-31 11:11:40,169 - INFO - Excel 文件已成功生成并保存到: 远传表出账明细.xlsx
2025-10-31 11:15:21,648 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31'
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 11:15:21,649 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 74697, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 1058, 'seq': 8}]
2025-10-31 11:15:21,649 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期户表出账(支)': 79765, '本周期户表应出账(支)': 84022, '本周期大路表出账(支)': 732, '本周期大路表应出账(支)': 3804, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 74697, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 1058}}
2025-10-31 11:15:22,101 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31'
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 11:15:22,101 - INFO - SQL执行结果:[{'count': 41937, 'seq': 1}, {'count': 43003, 'seq': 2}, {'count': 169, 'seq': 3}, {'count': 1209, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 879, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 67, 'seq': 8}]
2025-10-31 11:15:22,101 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期户表出账(支)': 41937, '本周期户表应出账(支)': 43003, '本周期大路表出账(支)': 169, '本周期大路表应出账(支)': 1209, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 879, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 67}}
2025-10-31 11:15:36,842 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31'
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 11:15:36,842 - INFO - SQL执行结果:[{'count': 79765, 'seq': 1}, {'count': 84022, 'seq': 2}, {'count': 732, 'seq': 3}, {'count': 3804, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 74697, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 1058, 'seq': 8}]
2025-10-31 11:15:36,842 - INFO - 处理后数据：{'company': 'ds_sjs', 'data': {'本周期户表出账(支)': 79765, '本周期户表应出账(支)': 84022, '本周期大路表出账(支)': 732, '本周期大路表应出账(支)': 3804, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 74697, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 1058}}
2025-10-31 11:15:37,590 - INFO - 当前执行sql:select count(*),1 as seq from water_revenue.water_meter_read where client_type = '1' and mr_enter_staff = '远传' 
union all 
select count(*) ,2 as seq from water_revenue.water_meter_read where client_type = '1' and account_opening_plan ='1'
union all
select count(*),3 as seq from water_revenue.water_meter_read where client_type = '2' and mr_enter_staff = '远传' 
union all 
select count(*) ,4 as seq from water_revenue.water_meter_read where client_type = '2' and account_opening_plan ='1'
union all 
select count(*) ,5 as seq from water_revenue.water_meter_read_his_2025 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and mr_input_time <= '2025-09-30'
union all 
select count(*) ,6 as seq from water_revenue.water_meter_read_his_2024 where client_type = '1' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and mr_input_time <= '2024-10-31'
union all
select count(*) ,7 as seq from water_revenue.water_meter_read_his_2025 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2025-09' and work_day <= '31'
union all
select count(*) ,8 as seq from water_revenue.water_meter_read_his_2024 where client_type = '2' and account_opening_plan ='1' and mr_enter_staff = '远传' and mr_month='2024-10' and work_day <= '31'
order by seq

2025-10-31 11:15:37,591 - INFO - SQL执行结果:[{'count': 41937, 'seq': 1}, {'count': 43003, 'seq': 2}, {'count': 169, 'seq': 3}, {'count': 1209, 'seq': 4}, {'count': 0, 'seq': 5}, {'count': 879, 'seq': 6}, {'count': 0, 'seq': 7}, {'count': 67, 'seq': 8}]
2025-10-31 11:15:37,591 - INFO - 处理后数据：{'company': 'ds_cxd', 'data': {'本周期户表出账(支)': 41937, '本周期户表应出账(支)': 43003, '本周期大路表出账(支)': 169, '本周期大路表应出账(支)': 1209, '上周期户表出账(支)': 0, '去年周期户表出账(支)': 879, '上周期大路表出账(支)': 0, '去年周期大路表出账(支)': 67}}
2025-10-31 11:15:37,605 - INFO - 已将 石景山 数据写入 Excel 第 2 列 (B 列)。
2025-10-31 11:15:37,605 - INFO - 已将 长辛店 数据写入 Excel 第 3 列 (C 列)。
2025-10-31 11:15:37,619 - INFO - Excel 文件已成功生成并保存到: 远传表出账明细.xlsx
2025-10-31 15:35:20,013 - INFO - =      开始执行 XXL-Job 配置巡检任务      =

2025-10-31 15:35:21,629 - INFO - 
--- 开始逐一校验任务配置 ---
2025-10-31 15:35:21,629 - INFO - 
--- 校验任务: 清北大路表远传表出账 (ID: 1079) ---
2025-10-31 15:35:21,632 - INFO - 
--- 校验任务: 怀柔、檀州大路表远传表出账 (ID: 1078) ---
2025-10-31 15:35:21,632 - INFO - 
--- 校验任务: 通州大路表远传表出账 (ID: 1074) ---
2025-10-31 15:35:21,633 - INFO - 
--- 校验任务: 良泉大路表远传表出账 (ID: 1073) ---
2025-10-31 15:35:21,633 - INFO - 
--- 校验任务: 门头沟、缙阳大路表远传表出账 (ID: 1071) ---
2025-10-31 15:35:21,633 - INFO - 
--- 校验任务: 大兴大路表远传表出账 (ID: 1070) ---
2025-10-31 15:35:21,634 - INFO - 
--- 校验任务: 石景山大路表远传表出账 (ID: 1069) ---
2025-10-31 15:35:21,635 - INFO - =      开始执行 XXL-Job 配置巡检任务      =

2025-10-31 15:35:22,097 - INFO - 
--- 开始逐一校验任务配置 ---
2025-10-31 15:35:22,097 - INFO - 
--- 校验任务: 户表远传表出账(非良泉\石景山) (ID: 1023) ---
2025-10-31 15:35:22,097 - INFO - 
--- 校验任务: 户表远传表出账(石景山) (ID: 1084) ---
2025-10-31 15:35:22,098 - INFO - 
--- 校验任务: 户表远传表出账(良泉) (ID: 1072) ---
2025-10-31 15:37:47,429 - INFO - =      开始执行 XXL-Job 配置巡检任务      =

2025-10-31 15:37:47,543 - INFO - 
--- 开始逐一校验任务配置 ---
2025-10-31 15:37:47,543 - INFO - 
--- 校验任务: 清北大路表远传表出账 (ID: 1079) ---
2025-10-31 15:37:47,544 - INFO - 
--- 校验任务: 怀柔、檀州大路表远传表出账 (ID: 1078) ---
2025-10-31 15:37:47,545 - INFO - 
--- 校验任务: 通州大路表远传表出账 (ID: 1074) ---
2025-10-31 15:37:47,545 - INFO - 
--- 校验任务: 良泉大路表远传表出账 (ID: 1073) ---
2025-10-31 15:37:47,545 - INFO - 
--- 校验任务: 门头沟、缙阳大路表远传表出账 (ID: 1071) ---
2025-10-31 15:37:47,547 - INFO - 
--- 校验任务: 大兴大路表远传表出账 (ID: 1070) ---
2025-10-31 15:37:47,547 - INFO - 
--- 校验任务: 石景山大路表远传表出账 (ID: 1069) ---
2025-10-31 15:37:47,548 - INFO - =      开始执行 XXL-Job 配置巡检任务      =

2025-10-31 15:37:47,646 - INFO - 
--- 开始逐一校验任务配置 ---
2025-10-31 15:37:47,646 - INFO - 
--- 校验任务: 户表远传表出账(非良泉\石景山) (ID: 1023) ---
2025-10-31 15:37:47,647 - INFO - 
--- 校验任务: 户表远传表出账(石景山) (ID: 1084) ---
2025-10-31 15:37:47,648 - INFO - 
--- 校验任务: 户表远传表出账(良泉) (ID: 1072) ---
2025-10-31 15:37:53,894 - INFO - =      开始执行 XXL-Job 配置巡检任务      =

2025-10-31 15:37:54,134 - INFO - 
--- 开始逐一校验任务配置 ---
2025-10-31 15:37:54,134 - INFO - 
--- 校验任务: 清北大路表远传表出账 (ID: 1079) ---
2025-10-31 15:37:54,135 - INFO - 
--- 校验任务: 怀柔、檀州大路表远传表出账 (ID: 1078) ---
2025-10-31 15:37:54,136 - INFO - 
--- 校验任务: 通州大路表远传表出账 (ID: 1074) ---
2025-10-31 15:37:54,136 - INFO - 
--- 校验任务: 良泉大路表远传表出账 (ID: 1073) ---
2025-10-31 15:37:54,136 - INFO - 
--- 校验任务: 门头沟、缙阳大路表远传表出账 (ID: 1071) ---
2025-10-31 15:37:54,137 - INFO - 
--- 校验任务: 大兴大路表远传表出账 (ID: 1070) ---
2025-10-31 15:37:54,137 - INFO - 
--- 校验任务: 石景山大路表远传表出账 (ID: 1069) ---
2025-10-31 15:37:54,138 - INFO - =      开始执行 XXL-Job 配置巡检任务      =

2025-10-31 15:37:54,366 - INFO - 
--- 开始逐一校验任务配置 ---
2025-10-31 15:37:54,366 - INFO - 
--- 校验任务: 户表远传表出账(非良泉\石景山) (ID: 1023) ---
2025-10-31 15:37:54,366 - INFO - 
--- 校验任务: 户表远传表出账(石景山) (ID: 1084) ---
2025-10-31 15:37:54,366 - INFO - 
--- 校验任务: 户表远传表出账(良泉) (ID: 1072) ---
2025-10-31 15:39:09,875 - INFO - =      开始执行 XXL-Job 配置巡检任务      =

2025-10-31 15:39:09,875 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:39:10,111 - INFO - 
--- 开始逐一校验任务配置 ---
2025-10-31 15:39:10,111 - INFO - 
--- 校验任务: 清北大路表远传表出账 (ID: 1079) ---
2025-10-31 15:39:10,111 - INFO - 
--- 校验任务: 怀柔、檀州大路表远传表出账 (ID: 1078) ---
2025-10-31 15:39:10,112 - INFO - 
--- 校验任务: 通州大路表远传表出账 (ID: 1074) ---
2025-10-31 15:39:10,113 - INFO - 
--- 校验任务: 良泉大路表远传表出账 (ID: 1073) ---
2025-10-31 15:39:10,114 - INFO - 
--- 校验任务: 门头沟、缙阳大路表远传表出账 (ID: 1071) ---
2025-10-31 15:39:10,114 - INFO - 
--- 校验任务: 大兴大路表远传表出账 (ID: 1070) ---
2025-10-31 15:39:10,114 - INFO - 
--- 校验任务: 石景山大路表远传表出账 (ID: 1069) ---
2025-10-31 15:39:10,116 - INFO - =      开始执行 XXL-Job 配置巡检任务      =

2025-10-31 15:39:10,116 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:39:10,289 - INFO - 
--- 开始逐一校验任务配置 ---
2025-10-31 15:39:10,289 - INFO - 
--- 校验任务: 户表远传表出账(非良泉\石景山) (ID: 1023) ---
2025-10-31 15:39:10,289 - INFO - 
--- 校验任务: 户表远传表出账(石景山) (ID: 1084) ---
2025-10-31 15:39:10,289 - INFO - 
--- 校验任务: 户表远传表出账(良泉) (ID: 1072) ---
2025-10-31 15:40:24,927 - INFO - =      开始执行 XXL-Job 配置巡检任务      =

2025-10-31 15:40:24,927 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:40:25,003 - INFO - 登录成功！
2025-10-31 15:40:25,105 - INFO - 成功获取到 3 条任务数据。
2025-10-31 15:40:25,105 - INFO - 
--- 开始逐一校验任务配置 ---
2025-10-31 15:40:25,105 - INFO - 
--- 校验任务: 清北大路表远传表出账 (ID: 1079) ---
2025-10-31 15:40:25,105 - ERROR - 校验失败：在任务列表中未找到 ID 为 1079 的任务。
2025-10-31 15:40:25,105 - INFO - 
--- 校验任务: 怀柔、檀州大路表远传表出账 (ID: 1078) ---
2025-10-31 15:40:25,106 - ERROR - 校验失败：在任务列表中未找到 ID 为 1078 的任务。
2025-10-31 15:40:25,106 - INFO - 
--- 校验任务: 通州大路表远传表出账 (ID: 1074) ---
2025-10-31 15:40:25,106 - ERROR - 校验失败：在任务列表中未找到 ID 为 1074 的任务。
2025-10-31 15:40:25,106 - INFO - 
--- 校验任务: 良泉大路表远传表出账 (ID: 1073) ---
2025-10-31 15:40:25,106 - ERROR - 校验失败：在任务列表中未找到 ID 为 1073 的任务。
2025-10-31 15:40:25,106 - INFO - 
--- 校验任务: 门头沟、缙阳大路表远传表出账 (ID: 1071) ---
2025-10-31 15:40:25,106 - ERROR - 校验失败：在任务列表中未找到 ID 为 1071 的任务。
2025-10-31 15:40:25,106 - INFO - 
--- 校验任务: 大兴大路表远传表出账 (ID: 1070) ---
2025-10-31 15:40:25,106 - ERROR - 校验失败：在任务列表中未找到 ID 为 1070 的任务。
2025-10-31 15:40:25,106 - INFO - 
--- 校验任务: 石景山大路表远传表出账 (ID: 1069) ---
2025-10-31 15:40:25,106 - ERROR - 校验失败：在任务列表中未找到 ID 为 1069 的任务。
2025-10-31 15:40:25,106 - INFO - 注意！部分任务配置存在不匹配项，请检查以上日志！
2025-10-31 15:40:25,106 - INFO - =      开始执行 XXL-Job 配置巡检任务      =

2025-10-31 15:40:25,106 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:40:25,199 - INFO - 登录成功！
2025-10-31 15:40:25,248 - INFO - 成功获取到 1 条任务数据。
2025-10-31 15:40:25,249 - INFO - 
--- 开始逐一校验任务配置 ---
2025-10-31 15:40:25,249 - INFO - 
校验任务: 户表远传表出账(非良泉\石景山) (ID: 1023) ---
2025-10-31 15:40:25,249 - ERROR - 校验失败：在任务列表中未找到 ID 为 1023 的任务。
2025-10-31 15:40:25,249 - INFO - 
校验任务: 户表远传表出账(石景山) (ID: 1084) ---
2025-10-31 15:40:25,249 - ERROR - 校验失败：在任务列表中未找到 ID 为 1084 的任务。
2025-10-31 15:40:25,249 - INFO - 
校验任务: 户表远传表出账(良泉) (ID: 1072) ---
2025-10-31 15:40:25,249 - ERROR - 校验失败：在任务列表中未找到 ID 为 1072 的任务。
2025-10-31 15:40:25,249 - INFO - 注意！部分任务配置存在不匹配项，请检查以上日志！
2025-10-31 15:41:17,898 - INFO - =      开始执行 XXL-Job 配置巡检任务      =
2025-10-31 15:41:17,898 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:41:18,015 - INFO - 登录成功！
2025-10-31 15:41:18,015 - INFO - 正在获取任务列表...
2025-10-31 15:41:18,053 - INFO - 成功获取到 3 条任务数据。
2025-10-31 15:41:18,053 - INFO - 
--- 开始逐一校验任务配置 ---
2025-10-31 15:41:18,053 - INFO - 
--- 校验任务: 清北大路表远传表出账 (ID: 1079) ---
2025-10-31 15:41:18,053 - ERROR - 校验失败：在任务列表中未找到 ID 为 1079 的任务。
2025-10-31 15:41:18,053 - INFO - 
--- 校验任务: 怀柔、檀州大路表远传表出账 (ID: 1078) ---
2025-10-31 15:41:18,053 - ERROR - 校验失败：在任务列表中未找到 ID 为 1078 的任务。
2025-10-31 15:41:18,054 - INFO - 
--- 校验任务: 通州大路表远传表出账 (ID: 1074) ---
2025-10-31 15:41:18,054 - ERROR - 校验失败：在任务列表中未找到 ID 为 1074 的任务。
2025-10-31 15:41:18,054 - INFO - 
--- 校验任务: 良泉大路表远传表出账 (ID: 1073) ---
2025-10-31 15:41:18,054 - ERROR - 校验失败：在任务列表中未找到 ID 为 1073 的任务。
2025-10-31 15:41:18,054 - INFO - 
--- 校验任务: 门头沟、缙阳大路表远传表出账 (ID: 1071) ---
2025-10-31 15:41:18,054 - ERROR - 校验失败：在任务列表中未找到 ID 为 1071 的任务。
2025-10-31 15:41:18,054 - INFO - 
--- 校验任务: 大兴大路表远传表出账 (ID: 1070) ---
2025-10-31 15:41:18,054 - ERROR - 校验失败：在任务列表中未找到 ID 为 1070 的任务。
2025-10-31 15:41:18,054 - INFO - 
--- 校验任务: 石景山大路表远传表出账 (ID: 1069) ---
2025-10-31 15:41:18,054 - ERROR - 校验失败：在任务列表中未找到 ID 为 1069 的任务。
2025-10-31 15:41:18,054 - INFO - 注意！部分任务配置存在不匹配项，请检查以上日志！
2025-10-31 15:41:18,054 - INFO - =      开始执行 XXL-Job 配置巡检任务      =
2025-10-31 15:41:18,054 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:41:18,125 - INFO - 登录成功！
2025-10-31 15:41:18,126 - INFO - 正在获取任务列表...
2025-10-31 15:41:18,164 - INFO - 成功获取到 1 条任务数据。
2025-10-31 15:41:18,164 - INFO - 
--- 开始逐一校验任务配置 ---
2025-10-31 15:41:18,164 - INFO - 
校验任务: 户表远传表出账(非良泉\石景山) (ID: 1023) ---
2025-10-31 15:41:18,164 - ERROR - 校验失败：在任务列表中未找到 ID 为 1023 的任务。
2025-10-31 15:41:18,164 - INFO - 
校验任务: 户表远传表出账(石景山) (ID: 1084) ---
2025-10-31 15:41:18,164 - ERROR - 校验失败：在任务列表中未找到 ID 为 1084 的任务。
2025-10-31 15:41:18,164 - INFO - 
校验任务: 户表远传表出账(良泉) (ID: 1072) ---
2025-10-31 15:41:18,165 - ERROR - 校验失败：在任务列表中未找到 ID 为 1072 的任务。
2025-10-31 15:41:18,165 - INFO - 注意！部分任务配置存在不匹配项，请检查以上日志！
2025-10-31 15:41:42,392 - INFO - =      开始执行 XXL-Job 配置巡检任务      =
2025-10-31 15:41:42,392 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:41:42,522 - INFO - 登录成功！
2025-10-31 15:41:42,522 - INFO - 正在获取任务列表...
2025-10-31 15:41:42,555 - INFO - 成功获取到 3 条任务数据。
2025-10-31 15:41:42,555 - INFO - 
--- 开始逐一校验任务配置 ---
2025-10-31 15:41:42,555 - INFO - 
--- 校验任务: 清北大路表远传表出账 (ID: 1079) ---
2025-10-31 15:41:42,555 - ERROR - 校验失败：在任务列表中未找到 ID 为 1079 的任务。
2025-10-31 15:41:42,555 - INFO - 
--- 校验任务: 怀柔、檀州大路表远传表出账 (ID: 1078) ---
2025-10-31 15:41:42,555 - ERROR - 校验失败：在任务列表中未找到 ID 为 1078 的任务。
2025-10-31 15:41:42,555 - INFO - 
--- 校验任务: 通州大路表远传表出账 (ID: 1074) ---
2025-10-31 15:41:42,555 - ERROR - 校验失败：在任务列表中未找到 ID 为 1074 的任务。
2025-10-31 15:41:42,556 - INFO - 
--- 校验任务: 良泉大路表远传表出账 (ID: 1073) ---
2025-10-31 15:41:42,556 - ERROR - 校验失败：在任务列表中未找到 ID 为 1073 的任务。
2025-10-31 15:41:42,556 - INFO - 
--- 校验任务: 门头沟、缙阳大路表远传表出账 (ID: 1071) ---
2025-10-31 15:41:42,556 - ERROR - 校验失败：在任务列表中未找到 ID 为 1071 的任务。
2025-10-31 15:41:42,556 - INFO - 
--- 校验任务: 大兴大路表远传表出账 (ID: 1070) ---
2025-10-31 15:41:42,556 - ERROR - 校验失败：在任务列表中未找到 ID 为 1070 的任务。
2025-10-31 15:41:42,556 - INFO - 
--- 校验任务: 石景山大路表远传表出账 (ID: 1069) ---
2025-10-31 15:41:42,556 - ERROR - 校验失败：在任务列表中未找到 ID 为 1069 的任务。
2025-10-31 15:41:42,556 - INFO - 注意！部分任务配置存在不匹配项，请检查以上日志！
2025-10-31 15:41:42,556 - INFO - [大路表远传出账定时任务检查]
清北大路表远传表出账在任务列表中未找到!
怀柔、檀州大路表远传表出账在任务列表中未找到!
通州大路表远传表出账在任务列表中未找到!
良泉大路表远传表出账在任务列表中未找到!
门头沟、缙阳大路表远传表出账在任务列表中未找到!
大兴大路表远传表出账在任务列表中未找到!
石景山大路表远传表出账在任务列表中未找到!

2025-10-31 15:41:42,556 - INFO - =      开始执行 XXL-Job 配置巡检任务      =
2025-10-31 15:41:42,556 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:41:42,617 - INFO - 登录成功！
2025-10-31 15:41:42,618 - INFO - 正在获取任务列表...
2025-10-31 15:41:42,646 - INFO - 成功获取到 1 条任务数据。
2025-10-31 15:41:42,646 - INFO - 
--- 开始逐一校验任务配置 ---
2025-10-31 15:41:42,646 - INFO - 
校验任务: 户表远传表出账(非良泉\石景山) (ID: 1023) ---
2025-10-31 15:41:42,646 - ERROR - 校验失败：在任务列表中未找到 ID 为 1023 的任务。
2025-10-31 15:41:42,646 - INFO - 
校验任务: 户表远传表出账(石景山) (ID: 1084) ---
2025-10-31 15:41:42,646 - ERROR - 校验失败：在任务列表中未找到 ID 为 1084 的任务。
2025-10-31 15:41:42,646 - INFO - 
校验任务: 户表远传表出账(良泉) (ID: 1072) ---
2025-10-31 15:41:42,646 - ERROR - 校验失败：在任务列表中未找到 ID 为 1072 的任务。
2025-10-31 15:41:42,646 - INFO - 注意！部分任务配置存在不匹配项，请检查以上日志！
2025-10-31 15:41:42,646 - INFO - [户表远传出账定时任务检查]
户表远传表出账(非良泉\石景山)在任务列表中未找到!
户表远传表出账(石景山)在任务列表中未找到!
户表远传表出账(良泉)在任务列表中未找到!

2025-10-31 15:44:36,150 - INFO - =      开始执行 XXL-Job 配置巡检任务      =
2025-10-31 15:44:36,150 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:44:46,155 - ERROR - 登录请求失败: HTTPConnectionPool(host='172.16.14.26', port=11005): Max retries exceeded with url: /xxljobadmin/login (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x00000285880C5D30>, 'Connection to 172.16.14.26 timed out. (connect timeout=10)'))
2025-10-31 15:44:46,156 - ERROR - 
巡检任务因登录失败而中止。
2025-10-31 15:44:46,156 - INFO - None
2025-10-31 15:44:46,156 - INFO - =      开始执行 XXL-Job 配置巡检任务      =
2025-10-31 15:44:46,156 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:44:56,169 - ERROR - 登录请求失败: HTTPConnectionPool(host='172.16.14.26', port=11005): Max retries exceeded with url: /xxljobadmin/login (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000028588151950>, 'Connection to 172.16.14.26 timed out. (connect timeout=10)'))
2025-10-31 15:44:56,170 - ERROR - 
巡检任务因登录失败而中止。
2025-10-31 15:44:56,170 - INFO - None
2025-10-31 15:51:38,847 - INFO - =      开始执行 XXL-Job 配置巡检任务      =
2025-10-31 15:51:38,848 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:51:48,861 - ERROR - 登录请求失败: HTTPConnectionPool(host='172.16.14.26', port=11005): Max retries exceeded with url: /xxljobadmin/login (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x00000204A59A5D30>, 'Connection to 172.16.14.26 timed out. (connect timeout=10)'))
2025-10-31 15:51:48,862 - ERROR - 
巡检任务因登录失败而中止。
2025-10-31 15:51:48,862 - INFO - None
2025-10-31 15:51:48,862 - INFO - =      开始执行 XXL-Job 配置巡检任务      =
2025-10-31 15:51:48,862 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:51:58,871 - ERROR - 登录请求失败: HTTPConnectionPool(host='172.16.14.26', port=11005): Max retries exceeded with url: /xxljobadmin/login (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x00000204A5A11950>, 'Connection to 172.16.14.26 timed out. (connect timeout=10)'))
2025-10-31 15:51:58,871 - ERROR - 
巡检任务因登录失败而中止。
2025-10-31 15:51:58,871 - INFO - None
2025-10-31 15:53:25,313 - INFO - =      开始执行 XXL-Job 配置巡检任务      =
2025-10-31 15:53:25,313 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:53:35,318 - ERROR - 登录请求失败: HTTPConnectionPool(host='172.16.14.26', port=11005): Max retries exceeded with url: /xxljobadmin/login (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001E6D0585D30>, 'Connection to 172.16.14.26 timed out. (connect timeout=10)'))
2025-10-31 15:53:35,318 - ERROR - 
巡检任务因登录失败而中止。
2025-10-31 15:53:35,318 - INFO - None
2025-10-31 15:53:35,318 - INFO - =      开始执行 XXL-Job 配置巡检任务      =
2025-10-31 15:53:35,318 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:53:45,325 - ERROR - 登录请求失败: HTTPConnectionPool(host='172.16.14.26', port=11005): Max retries exceeded with url: /xxljobadmin/login (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001E6D05F1950>, 'Connection to 172.16.14.26 timed out. (connect timeout=10)'))
2025-10-31 15:53:45,325 - ERROR - 
巡检任务因登录失败而中止。
2025-10-31 15:53:45,325 - INFO - None
2025-10-31 15:55:22,848 - INFO - =      开始执行 XXL-Job 配置巡检任务      =
2025-10-31 15:55:22,849 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:55:32,854 - ERROR - 登录请求失败: HTTPConnectionPool(host='172.16.14.26', port=11005): Max retries exceeded with url: /xxljobadmin/login (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000027B65865D30>, 'Connection to 172.16.14.26 timed out. (connect timeout=10)'))
2025-10-31 15:55:32,855 - ERROR - 
巡检任务因登录失败而中止。
2025-10-31 15:55:32,855 - INFO - [大路表远传出账定时任务检查]
xxljob登录失败，无法检查
2025-10-31 15:55:32,855 - INFO - =      开始执行 XXL-Job 配置巡检任务      =
2025-10-31 15:55:32,855 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:55:42,859 - ERROR - 登录请求失败: HTTPConnectionPool(host='172.16.14.26', port=11005): Max retries exceeded with url: /xxljobadmin/login (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x0000027B658D5950>, 'Connection to 172.16.14.26 timed out. (connect timeout=10)'))
2025-10-31 15:55:42,859 - ERROR - 
巡检任务因登录失败而中止。
2025-10-31 15:55:42,859 - INFO - [户表远传出账定时任务检查]
xxljob登录失败，无法检查
2025-10-31 15:55:56,247 - INFO - =      开始执行 XXL-Job 配置巡检任务      =
2025-10-31 15:55:56,247 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:56:06,256 - ERROR - 登录请求失败: HTTPConnectionPool(host='172.16.14.26', port=11005): Max retries exceeded with url: /xxljobadmin/login (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001FD0C245D30>, 'Connection to 172.16.14.26 timed out. (connect timeout=10)'))
2025-10-31 15:56:06,256 - ERROR - 
巡检任务因登录失败而中止。
2025-10-31 15:56:06,256 - INFO - [大路表远传出账定时任务检查]
xxljob登录失败，无法检查
2025-10-31 15:56:06,256 - INFO - =      开始执行 XXL-Job 配置巡检任务      =
2025-10-31 15:56:06,256 - INFO - 正在尝试登录 XXL-Job...
2025-10-31 15:56:16,262 - ERROR - 登录请求失败: HTTPConnectionPool(host='172.16.14.26', port=11005): Max retries exceeded with url: /xxljobadmin/login (Caused by ConnectTimeoutError(<urllib3.connection.HTTPConnection object at 0x000001FD0C2D5950>, 'Connection to 172.16.14.26 timed out. (connect timeout=10)'))
2025-10-31 15:56:16,263 - ERROR - 
巡检任务因登录失败而中止。
2025-10-31 15:56:16,263 - INFO - [户表远传出账定时任务检查]
xxljob登录失败，无法检查
2025-10-31 16:02:45,318 - INFO - =      开始执行 XXL-Job 配置巡检任务      =
2025-10-31 16:02:45,318 - INFO - 正在尝试登录 XXL-Job...
